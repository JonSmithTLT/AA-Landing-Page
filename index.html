<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asynchronous Applications Sentiment Analysis</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header class = "nav-container">
        <a src="/" id = logo> Asynchronous Applications Sentiment Analysis</a>
        <nav>
            <ul>
                <li><a href='index.html'>Home</a></li>
                <li><button id = "show-login" type = "button">Login</button></li>
                <li><button class = "show-register" type = "button">Register</a></li>
            </ul>
        </nav>
    </header>

    <div class = "popup" id = "register-popup">
        <div class = "close-button">&times;</div>
        <h2>Register</h2>
        <form id = "register">
            <div class = "form-element">
                <label for = "email">Email</label>
                <input type = "email" name = "email" placeholder="example@email.com" id = "login-email" required>
            </div>

            <div class = "form-element">
                <label for = "password">Password</label>
                <input type = "password" name = "password" placeholder="**********" id = "login-password" required>
            </div>

            <div class = "form-element">
                <button type = "button" id = "register-button" onclick = "registerSubmit()">Register</button>
            </div>
        </form>
    </div>

    <div class = "popup" id = "twt-popup">
        <div class = "close-button">&times;</div>
        <h2>Twitter Tasks</h2>
        <form id = "twt-form">
            <div class = "form-element">
                <label for = "source">Source ID</label>
                <input type = "text" name = "source" id = "source" required>
            </div>

            <div class = "form-element">
                <label for = "task">Task</label>
                <input type = "text" id = "task" name = "task" placeholder = "This is where you enter the task or query you want data on." id = "description" required>
            </div>

            <div class = "form-element">
                <label for = "description">Description</label>
                <input type = "text" name = "description" placeholder="This is where you enter a description regarding what the task is meant to do." required>
            </div>

            <div class = "form-element">
                <select name = "frequency" id = "frequency" title="Frequency" required>
                    <option selected disabled>Choose Frequency</option>
                    <option value= 30>30 sec</option>
                    <option value= 60>60 sec</option>
                    <option value= 90>90 sec</option>
                </select>
            </div>

            <div class = "form-element">
                <label for = "enabled">Enabled</label>
                <input type = "checkbox" name = "enabled" id = "enabled">
            </div>

            <div class = "form-element">
                <button type = "button" id = "task-button" onclick = "taskSubmit()">Submit</button>
            </div>
        </form>
    </div>

    <div class = "popup" id = "login-popup">
        <div class = "close-button">&times;</div>
        <h2>Login</h2>
        <form id = "login">
            <div class = "form-element">
                <label for = "email">Email</label>
                <input type = "email" name = "email" placeholder="example@email.com" id = "register-email" required>
            </div>

            <div class = "form-element">
                <label for = "password">Password</label>
                <input type = "password" name = "password" placeholder="**********" id = "register-password" required>
            </div>

            <div class = "form-element">
                <button type = "button" id = "login-button" onclick = "loginSubmit()">Sign In</button>
            </div>
        </form>
    </div>

    <div id = "hero">
        <div class = "hero-text">
            <h1 id = "hero-main-text">Welcome to Async Apps Sentiment Analysis and Social Media Scraper</h1>
            <p id = "hero-secondary-text">This service provides real-time social media posts and processing to see whats currently trending in the world!</p>
            <button type = "button" class = "show-register">Sign Up!</button>
        </div>
        <div class = "image">
            <img src="img/Social-media.jpg" alt = "Photo of Social Media Apps" width = 600px>
        </div>
    </div>

    <h2>Supported Services</h2>
        <div class = "flex-container">
            <ul id = "services">
                <li><button type = "button" id = "twitter-tasks"><img src = 'img/twitter-logo.png' alt = 'Twitter' width = '100px' ></button></li>
                <li><a href='reddit.html'><img src = 'img/reddit-logo.png' alt = 'Reddit' width = 100px> </a></li>
                <li><a href='facebook.html'><img src = 'img/facebook-logo.png' alt = 'Facebook' width = 100px></a></li>
                <li><a href='telegram.html'><img src = 'img/telegram-logo.png' alt = 'Telegram' width = 100px></a></li>
                <li><a href='discord.html'><img src = 'img/discord-logo.png' alt = 'Discord' width = 100px></a></li>
            </ul>
        </div>
    <div class = "quote">
        <blockquote cite = 'https://www.vennli.com/blog/21-quotes-to-inspire-your-adventures-in-analytics'>
            <p>"An intelligent person is never afraid or ashamed to find errors in his understanding of things."</p>
            <p>- Bryant H. McGill</p>
        </blockquote>
    </div>
    <div class = "sign-up">
        <h4>Register for our service!</h4>
        <p>Signup to add tasks and view the data we are collecting for you!</p>
        <button class = "show-register" type = "button">Sign Up!</button>
    </div>

    <footer> Copyright Asynchronous Applications 2023</footer>

    
</body>

<script>
    /*Nav Login Register Open Popup*/
    document.querySelector("#show-login").addEventListener("click", function(){
        document.querySelector("#login-popup").classList.add("active");
    });

    document.querySelector(".show-register").addEventListener("click", function(){
        document.querySelector("#register-popup").classList.add("active");
    });

    /*Nav Login Register Close Popup*/
    document.querySelector("#register-popup .close-button").addEventListener("click", function(){
        document.querySelector("#register-popup").classList.remove("active");
    });

    document.querySelector("#login-popup .close-button").addEventListener("click", function(){
        document.querySelector("#login-popup").classList.remove("active");
    });

    /*Bottom Sign-up Popup*/
    document.querySelector(".sign-up .show-register").addEventListener("click", function(){
        document.querySelector("#register-popup").classList.add("active");
    });

    document.querySelector("#register-popup .close-button").addEventListener("click", function(){
        document.querySelector("#register-popup").classList.remove("active");
    });

    /*Hero Text Sign-up Popup*/
    document.querySelector("#hero .hero-text .show-register").addEventListener("click", function(){
        document.querySelector("#register-popup").classList.add("active");
    });

    document.querySelector("#register-popup .close-button").addEventListener("click", function(){
        document.querySelector("#register-popup").classList.remove("active");
    });

    document.querySelector(".flex-container #services #twitter-tasks").addEventListener("click", function(){
        document.querySelector("#twt-popup").classList.add("active");
    });

    document.querySelector("#twt-popup .close-button").addEventListener("click", function(){
        document.querySelector("#twt-popup").classList.remove("active");
    });

    function loginSubmit() {
            const loginForm = document.querySelector('.popup #login');
            const data = new FormData(loginForm);
            const object = {};
            data.forEach(function(value,key) {
                console.log(key);
                console.log(data);
                object[key] = value;
            })
            const json = JSON.stringify(object);
            console.log(json)

            fetch("https://sv-api.learncs.io/login", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                credentials: "include",
                body: json
            })

            .then(response => {
                if (!response.ok) {
                    return Promise.reject(response);
                }
                return response.json();
            })
            .then(data => {
                console.log("Success");
                console.log(data);
                window.location = "tasks.html"
            })
            .catch(error => {
                if (typeof error.json === "function") {
                    error.json().then(jsonError => {
                        console.log("JSON error from API");
                        console.log(error.statusText);
                    })
                } else {
                    console.log("Fetch error");
                    console.log(error);
                }
            })
        }



        function registerSubmit() {
            const registerForm = document.querySelector('.popup #register');
            const data = new FormData(registerForm);
            console.log(data);
            const object = {};
            data.forEach(function(value,key) {
                object[key] = value;
            })
            const json = JSON.stringify(object);
            console.log(json)

            fetch("https://sv-api.learncs.io/register", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: json
            })

            .then(response => {
                if (!response.ok) {
                    return Promise.reject(response);
                }
                return response.json();
            })
            .then(data => {
                console.log("Success");
                console.log(data);
                window.location = "tasks.html"
            })
            .catch(error => {
                if (typeof error.json === "function") {
                    error.json().then(jsonError => {
                        console.log("JSON error from API");
                        console.log(error.statusText);
                    })
                } else {
                    console.log("Fetch error");
                    console.log(error);
                }
            })
        }
        
        function taskSubmit() {
            const taskForm = document.querySelector('.popup #twt-form');
            const data = new FormData(taskForm);
            const object = {};
            data.forEach(function(value,key) {
                if (key === "frequency") {
                    console.log(Number(value));
                    object[key] = Number(value);
                } else if (key === "enabled"){
                    if (value === "on") {
                        object[key] = 1;
                    } else {
                        object[key] = 0;
                    }
                } else {
                    object[key] = value;
                }
            })
            const json = JSON.stringify(object);
            console.log(json);

            fetch("https://sv-api.learncs.io/task", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: json
            })

            .then(response => {
                if (!response.ok) {
                    return Promise.reject(response);
                }
                return response.json();
            })
            .then(data => {
                console.log("Success");
                console.log(data);
                window.location = "tasks.html"
            })
            .catch(error => {
                if (typeof error.json === "function") {
                    error.json().then(jsonError => {
                        console.log("JSON error from API");
                        console.log(error.statusText);
                    })
                } else {
                    console.log("Fetch error");
                    console.log(error);
                }
            })
        }
    </script>
</html>