<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AA Login</title>
    <link rel = 'stylesheet' href="css/styles.css">
</head>
<body>
    <script>
        function loginSubmit() {
            const loginForm = document.querySelector('#login');
            const data = new FormData(loginForm);
            const object = {};
            data.forEach(function(value,key) {
                object[key] = value;
            })
            const json = JSON.stringify(object);
            console.log(json)

            fetch("https://sv-api.learncs.io/login", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: json
            })

            .then(response => {
                if (!response.ok) {
                    return Promise.reject(response);
                }
                return response.json();
            })
            .then(data => {
                console.log("Success");
                console.log(data);
                window.location = "index.html"
            })
            .catch(error => {
                if (typeof error.json === "function") {
                    error.json().then(jsonError => {
                        console.log("JSON error from API");
                        console.log(error.statusText);
                    })
                } else {
                    console.log("Fetch error");
                    console.log(error);
                }
            })

            /*const xhr = new XMLHttpRequest();
            xhr.open('POST', "https://sv-api.learncs.io/login");
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.send(json);*/
        }
    </script>
    <header class = "nav-container">
        <a src="/" id = logo> Asynchronous Applications Sentiment Analysis</a>
        <nav>
            <li><a href='index.html'>Home</a></li>
            <li><a href="tasks.html">Tasks</a></li>
            <li><a href = 'login.html'>Login</a></li>
            <li><a href='register.html'>Register</a></li>
        </nav>
    </header>
    <form id = "login">
        <label for ="email">Email</label>
        <input type = "email" id = "email" name = "email" placeholder="example@email.com" required>
        <br>
        <label for = "password">Password</label>
        <input type = "password" id = "password" name = "password" placeholder="**********" required>
        <br>
        <button type="button" id = "login-submit" onclick="loginSubmit()">Login</button>
    </form>
</body>
</html>